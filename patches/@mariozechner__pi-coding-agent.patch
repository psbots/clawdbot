diff --git a/dist/config.js b/dist/config.js
index 78f4b0995fb29e6a527b8f3b1659e24f4b2c71cb..ee1d6aff95b45f8af1bd524decb26f5b0ffc2bd3 100644
--- a/dist/config.js
+++ b/dist/config.js
@@ -10,8 +10,11 @@ const __dirname = dirname(__filename);
 /**
  * Detect if we're running as a Bun compiled binary.
  * Bun binaries have import.meta.url containing "$bunfs", "~BUN", or "%7EBUN" (Bun's virtual filesystem path)
+ * Some packaging workflows keep import.meta.url as a file:// path, so fall back to execPath next to package.json.
  */
-export const isBunBinary = import.meta.url.includes("$bunfs") || import.meta.url.includes("~BUN") || import.meta.url.includes("%7EBUN");
+const bunBinaryByUrl = import.meta.url.includes("$bunfs") || import.meta.url.includes("~BUN") || import.meta.url.includes("%7EBUN");
+const bunBinaryByExecPath = existsSync(join(dirname(process.execPath), "package.json"));
+export const isBunBinary = bunBinaryByUrl || bunBinaryByExecPath;
 // =============================================================================
 // Package Asset Paths (shipped with executable)
 // =============================================================================
diff --git a/dist/core/sdk.d.ts b/dist/core/sdk.d.ts
index 8654daf0e59cc56219a48a25fefa37eeb400676d..a17d5ed426b6f228a89d8248d2f913be569e87dc 100644
--- a/dist/core/sdk.d.ts
+++ b/dist/core/sdk.d.ts
@@ -90,6 +90,8 @@ export interface CreateAgentSessionOptions {
     sessionManager?: SessionManager;
     /** Settings manager. Default: SettingsManager.create(cwd, agentDir) */
     settingsManager?: SettingsManager;
+    /** Custom stream function for provider routing (e.g., Bedrock support) */
+    streamFn?: (model: Model<any>, context: any, options?: any) => any;
 }
 /** Result from createAgentSession */
 export interface CreateAgentSessionResult {
diff --git a/dist/core/sdk.js b/dist/core/sdk.js
index 46594910c8d1a2ff6bfd0b7dd253c3e46fb08062..e9a17e83fda72b8d0cfa0a77a616b1311d7849f3 100644
--- a/dist/core/sdk.js
+++ b/dist/core/sdk.js
@@ -448,6 +448,7 @@ export async function createAgentSession(options = {}) {
             : undefined,
         steeringMode: settingsManager.getSteeringMode(),
         followUpMode: settingsManager.getFollowUpMode(),
+        streamFn: options.streamFn,
         getApiKey: async () => {
             const currentModel = agent.state.model;
             if (!currentModel) {
